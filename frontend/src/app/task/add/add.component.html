<div class="container mt-4">
  <h2>Add New Task</h2>

  <form (ngSubmit)="addTask()" #taskForm="ngForm">
    <!-- Title Field -->
    <div class="form-group">
      <label for="title">Title</label>
      <input
        id="title"
        class="form-control"
        type="text"
        [(ngModel)]="newTask.title"
        name="title"
        required
        #title="ngModel"
      />
      <div *ngIf="title.invalid && title.touched" class="text-danger">
        Title is required.
      </div>
    </div>

    <!-- Description Field -->
    <div class="form-group">
      <label for="description">Description</label>
      <textarea
        id="description"
        class="form-control"
        [(ngModel)]="newTask.description"
        name="description"
        required
        #description="ngModel"
      ></textarea>
      <div *ngIf="description.invalid && description.touched" class="text-danger">
        Description is required.
      </div>
    </div>

    <!-- Due Date Field -->
    <div class="form-group">
      <label for="dueDate">Due Date</label>
      <input
        id="dueDate"
        class="form-control"
        type="date"
        [(ngModel)]="newTask.dueDate"
        name="dueDate"
        [min]="createdAt"

        required
        #dueDate="ngModel"
      />
      <div *ngIf="dueDate.invalid && dueDate.touched" class="text-danger">
        Due Date is required.
      </div>
    </div>

    <!-- Progress Dropdown -->
    <div class="form-group">
      <label for="progressId">Select Progress</label>
      <select
        id="progressId"
        class="form-control"
        [(ngModel)]="newTask.progressId"
        name="progressId"
      >
        <option [ngValue]="null">-- No Progress --</option>
        <option *ngFor="let progress of progressList" [ngValue]="progress.id">
          {{ progress.name }}
        </option>
      </select>
    </div>

    <!-- New Progress Input -->
    <div class="form-group">
      <label for="newProgress">Or Enter New Progress</label>
      <input
        id="newProgress"
        class="form-control"
        type="text"
        [(ngModel)]="newProgressName"
        name="newProgressName"
        placeholder="New progress name (optional)"
        [required]="newTask.progressId === null"
      />
      <div *ngIf="taskForm.submitted && newTask.progressId === null && !newProgressName" class="text-danger">
        New progress name is required when no progress is selected.
      </div>
    </div>
    <!-- Validation: Both Progress Fields Empty -->
    <div *ngIf="(taskForm.submitted && newTask.progressId === null && !newProgressName) " class="text-danger">
      Please select or enter a progress.
    </div>


    <!-- Validation for exclusive progress -->
    <div *ngIf="!isProgressExclusive()" class="text-danger">
      You cannot select both progress and enter a new progress at the same time.
    </div>

<!--    &lt;!&ndash; Completed Checkbox &ndash;&gt;-->
<!--    <div class="form-check my-2">-->
<!--      <input-->
<!--        id="completed"-->
<!--        class="form-check-input"-->
<!--        type="checkbox"-->
<!--        [(ngModel)]="newTask.completed"-->
<!--        name="completed"-->
<!--      />-->
<!--      <label class="form-check-label" for="completed">Completed</label>-->
<!--    </div>-->

    <button class="btn btn-primary mt-3" type="submit" [disabled]="taskForm.invalid">
      Add Task
    </button>
  </form>
</div>
